
rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_D873 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "d8732eb8bd7240f17d90656424aabc0669c3d13e3117efc4805bb59dd21ceb1d"
		hash = "7c6f0f7062aca9c286fb921917747c8b65ff4a69eb71102b90c1570b4c521fea"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100380035003100350020002800770069006e0062006c00750065005f006c007400730062002e003100360031003000310032002d00300036003000300029 } /* FileVersion winblueltsb */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310038003500310035 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_7108 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootx64.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "71083eb4f247ac78f52aa09f81054396a0dac1064e1191b5b56a43a6976c5c74"
		hash = "e0df7ce01e42a61228f4005fcdb9c42675ff7280a0be9ec1c32ad9d5e0493f10"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0034002e0039003800340030002e00300020002800660062006c005f007300650063005f006f00730073003300280064006c0069006e0073006c006500790029002e003100340030003600310036002d00310031003200330029 } /* FileVersion fblsecossdlinsley */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0034002e0039003800340030002e0030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_6460 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootx64.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "64604ea91f31b815bd0219d56563b9c2d307fc6c71ecc38d498221e0e0e9c4ad"
		hash = "59e4fa86b1c3bb7df3cdb79a17ec36af9ad12e153172f6d8e662fcfb9dbb37d5"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0034002e0039003800320030002e00300020002800660062006c005f00730065006300280064006c0069006e0073006c006500790029002e003100340030003400320035002d00310030003300380029 } /* FileVersion fblsecdlinsley */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0034002e0039003800320030002e0030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_905C {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "905c2df524e664759d55a6dad4b62b58220adc59fec3e852964efc2165b0fc0c"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003100360033003900390020002800770069006e0038005f006700640072002e003100320030003800320030002d00320031003200330029 } /* FileVersion wingdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00310036003300390039 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_D038 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "d038eec123e1e13ab3ad27534de697c9779e9c27c62575f06771f80d3cbb7148"
		hash = "1eadf7bf5fde916884a4beb82dd68ba50be05413f00aae8571190a2eaa462640"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003200300033003600360020002800770069006e0062006c00750065005f006c007400730062005f0065007300630072006f0077002e003200320030003400310031002d00310037003200320029 } /* FileVersion winblueltsbescrow */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00320030003300360036 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_3FDA {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "3fda721bc5007eab23af6e0c56a6942a7925a858f0d801fbb21011ccf758893b"
		hash = "3f28c4f2fb32c10e5faed1debf7db6ae8c821bf286ffdb57a5b31fce0730e111"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100360034003100310020002800770069006e0062006c00750065005f006700640072002e003100330030003900320034002d00310038003000370029 } /* FileVersion winbluegdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310036003400310031 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_8858 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "88582f3cae30afd77990944709ac4e272d68cdc009d9c3ff6f7c2e19e74f5975"
		hash = "0b16ad93ee38243d72ff0acd790107767b6d7d3563a4ba8edb7a23eec5c8d531"
		hash = "86e5b25aa8072895e72e3d5f4beaccc1488a434fb10babe17fb9010da4ed93bc"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100360033003800340020002800770069006e0062006c00750065005f00720074006d002e003100330030003800320031002d00310036003200330029 } /* FileVersion winbluertm */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310036003300380034 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_4628 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "4628ec2698cfbca38d3bb4872df8e65a370ed4591e3fbd613a28b394942b8976"
		hash = "00550ccee4edfefd7b7fb54864d0aa5df059885e9e79ff80d4fb134b4487c05d"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100370031003000390020002800770069006e0062006c00750065005f006700640072002e003100340030003400320036002d00300031003100310029 } /* FileVersion winbluegdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310037003100300039 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_860C {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "860c16809e3941bebedff0bde99c32aa77379c0be1f6b174d20038a02162d3d5"
		hash = "566ae5fb2f355b2c03ecbbab4770e92856b0d1c3d659fe0c11263f1a5f8d7086"
		hash = "fd69741dcd1bc0d9ab8a02c2a7ee8d466a58613562536aa8aab5ea260bbdf9c3"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100380032003300330020002800770069006e0062006c00750065005f006c007400730062002e003100360030003200310030002d00300036003000300029 } /* FileVersion winblueltsb */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310038003200330033 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_D1AF {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "d1af02fca7522c8d27e053544b3b653ff2daffcae9c420e460235dacab53f7cd"
		hash = "90ea447ccfdcd9771de40de9721d0256d6d8a30d68963e82485c2e92b7eb5257"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003200320030003000340020002800770069006e0038005f006c00640072002e003100360031003000300035002d00300036003000300029 } /* FileVersion winldr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320032003000300034 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_EC89 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "ec89ddd37880430cd5242f5f15d13f4cf699f50dbe04643e5b70093631608204"
		hash = "9da10b25786d8db0167fd66c051f7e2655781bb561b99584312b439a32be4c32"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003200300035003200310020002800770069006e0038005f006c00640072002e003100320030003900310039002d00310038003100330029 } /* FileVersion winldr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320030003500320031 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_77E2 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "77e2945b3a2b0d14e9943f90ddd7bb87dde9cc5d8be09f9693e9f4166769363d"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003200300034003700360020002800770069006e0062006c00750065005f006c007400730062005f0065007300630072006f0077002e003200320030003600320037002d00310037003300310029 } /* FileVersion winblueltsbescrow */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00320030003400370036 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_F620 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootx64.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "f6208932ed98aa64f5ec0d9f59138d4c1dddbd82437315aac4aa913e5d4f825e"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e00610067006500720020002800540065007300740029 } /* FileDescription BootManagerTest */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0034002e0039003800350037002e00300020002800660062006c005f006b00700067005f006b00650072006e0065006c00280064006500640065007300610029002e003100340030003600330030002d00310037003500300029 } /* FileVersion fblkpgkerneldedesa */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0034002e0039003800350037002e0030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_FE26 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "fe26e6c2bc5ac4357e6657624180ca1e946d6dabe79cdb098d7b8b4e440851aa"
		hash = "165a5dcdea3a7de7cfae38298597445eba59282308c7243be50f568aa610f4f2"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100380036003300390020002800770069006e0062006c00750065005f006c007400730062002e003100370030003300320035002d00300036003000300029 } /* FileVersion winblueltsb */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310038003600330039 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_FEF5 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "fef56f20ef6e5065ed0fde1d85fd19f1f07212403489fd1e2b63aa41f5dc600b"
		hash = "ac22c4ad2e62a3a8369a311b69e9b3dd558359cb44de8115e6bef2ae5e5e7151"
		hash = "df216fa3f13f8f7472c9586da4d0a7cd11cd60a041f486a611a4667f1c3d2cc6"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100370032003100310020002800770069006e0062006c00750065005f006700640072002e003100340030003600310033002d00310037003000390029 } /* FileVersion winbluegdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310037003200310031 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_3927 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "3927727eb2435b28d2cf0ce1757e72ce3e92a86362b87120040c744c1c08bce9"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003200300037003700320020002800770069006e0062006c00750065005f006c007400730062005f0065007300630072006f0077002e003200320031003200310034002d00310037003200310029 } /* FileVersion winblueltsbescrow */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00320030003700370032 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_F025 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "f025a519dccf1df41951c22c6dc5cafa61e21b117e174b4983b45ccc22c6375f"
		hash = "5052ce3b96db73a909bf0e54355e357f8ab7284fa48f9b21c85efedbb886c100"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003200300033003000300020002800770069006e0062006c00750065005f006c007400730062005f0065007300630072006f0077002e003200320030003200310035002d00300037003000360029 } /* FileVersion winblueltsbescrow */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00320030003300300030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_88C2 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "88c2eac45b9480cc7e423558ba1b90097e8f12dbf98f4628c7a574c6371c6030"
		hash = "53af0ddbd3c4d33bd003403d8c9b41877e07770d3e789c781e5897858585e299"
		hash = "669353cc31e65f896a755db94a045d9dc1b4a24baba14fce11d623bdfacec78c"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100360034003100350020002800770069006e0062006c00750065005f006700640072002e003100330030003900320038002d00310036003500380029 } /* FileVersion winbluegdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310036003400310035 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_E443 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "e443176d6a0621e65cadde51f4019ec7fb25e91fa87cbb6cbaf09d94e9e49918"
		hash = "3bc9ed257486b68fac5899eaa19732a1340d06c8baf4b0ff53c7f5c052e6470f"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100370030003300310020002800770069006e0062006c00750065005f006700640072002e003100340030003200320031002d00310039003500320029 } /* FileVersion winbluegdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310037003000330031 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_B731 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "b7313be4901f1a80f84e4e8a6636f090e7125b97fc845d4454d5e4bef3d40ca7"
		hash = "62288f1f5f2f8529292eb45c2ae2a33d1057a3dec12164958e76ded36fbe712b"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003200300032003200370020002800770069006e0062006c00750065005f006c007400730062002e003200310031003200300034002d00310037003000300029 } /* FileVersion winblueltsb */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00320030003200320037 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_DBEB {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "dbeb49f986ec6618e7c256d3db4e3d5378a6ee3439c5949ae57e12722a73a198"
		hash = "4f3e97e36ec05236dc378c544310a9685d57409b87020bee731d7ddbf90987c6"
		hash = "dd3ca7c4bf6698e7d72f6c2fb0eb59997336c294d604062ef495ee8e1f49931c"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100380034003700380020002800770069006e0062006c00750065005f006c007400730062002e003100360030003900320030002d00300036003000300029 } /* FileVersion winblueltsb */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310038003400370038 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_C6B0 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "c6b0d030bb3e54294742b3914ae76c949e52a065abb28d08054fdf90d7eed628"
		hash = "9e14396bca7712b13a5f0b209c8633d754afc3bf577b42ef78304581ddd4e02f"
		hash = "79baff384ed507030cbe328a3d6c04d13e77932f08d387f76cf2422fb3b2588b"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003100360034003200300020002800770069006e0038005f006700640072002e003100320030003900310039002d00310038003100330029 } /* FileVersion wingdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00310036003400320030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_990A {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootx64.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "990a4dd8c86392421d680fa039af4e88d1ebdc97f61a73f8347d6b314fe8cd51"
		hash = "c643c3cc182443893728101f5303aaa05b08ec8616310546edc903635c692b5e"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0034002e0039003800380030002e00300020002800660062006c005f007300650063005f006f00730073003300280064006c0069006e0073006c006500790029002e003100340030003600310036002d00310031003200330029 } /* FileVersion fblsecossdlinsley */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0034002e0039003800380030002e0030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_E35C {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "e35cc798f138406bdc5e793574f62fe3be4c7dd6424aa6825e6ec7b2a345b591"
		hash = "25933d1597ead1c390abc59433aec7c8f955c588551024c88c6388afbc84ed40"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100380030003600370020002800770069006e0062006c00750065005f006c007400730062002e003100350030003900320039002d00300036003000300029 } /* FileVersion winblueltsb */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310038003000360037 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_4F93 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "4f9398592553ee138d8db48b95789eca19324b8408cafd0f0bc46d030e7b4fd4"
		hash = "db9643f6d78c6c5bdc29b041660174324639be8b3bc6e247c8c2026e68c4e618"
		hash = "783d088ce72996a064c0da796579475e0aef23c5e6e0e5905c98571bf8620e20"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003100360033003800340020002800770069006e0038005f00720074006d002e003100320030003700320035002d00310032003400370029 } /* FileVersion winrtm */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00310036003300380034 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_55A5 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootia32.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "55a5bb13e3a985e0ab011e69b41704319de0843f9254cf91ed2964c13af345fe"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310030003100320031002e00300020002800660062006c005f007300650063005f006f007300730033002e003100340030003500320033002d00310031003500360029 } /* FileVersion fblsecoss */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310030003100320031002e0030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_2B33 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "2b334e6b147104306dd91f77e900c07383c0ddff77c2979ec79ea5d92944c13d"
		hash = "132d59d83c29be7351d35c44b846dfc3f37b3c62bc40eac6aec3fd68e7cfcfde"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0034002e0039003800320030002e00300020002800660062006c005f00730065006300280064006c0069006e0073006c006500790029002e003100340030003400320035002d00310032003200350029 } /* FileVersion fblsecdlinsley */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0034002e0039003800320030002e0030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_5F39 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "5f3952cba19c9f225aae8b57e57c7e20505ac617aeca845a8b5cde4994405c92"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003100360034003100360020002800770069006e0038005f006700640072002e003100320030003900310033002d00310035003000320029 } /* FileVersion wingdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00310036003400310036 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_8119 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "81199ecb7a384d04f4e0f5541af731ca6ab0a04f1e2d692b4c386e0f02f15009"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003200300035003100360020002800770069006e0038005f006c00640072002e003100320030003900310033002d00310035003000330029 } /* FileVersion winldr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320030003500310036 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_F4C5 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "f4c53c0b054413691ba25a2d162bcde9c9e35b5e706272f70bff96ed5c05a7b8"
		hash = "0b753bd95ae643b2543f501533ca54db34ddc9d20f336358067a7069240a6214"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310030003000310030002e00300020002800660062006c005f006b00700067005f006b00650072006e0065006c002e003100340030003600330030002d00310037003500300029 } /* FileVersion fblkpgkernel */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310030003000310030002e0030 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_1604 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "1604f70608f964d1a835c3f3a421e58e449774f0291ff134ac298364e8e3f776"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003100360033003900310020002800770069006e0038005f006700640072002e003100320030003800300033002d00310036003000380029 } /* FileVersion wingdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00310036003300390031 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_0E93 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "0e93c368f8177bc0fe1a09d79b897a94286f3c374a18a40522c3358cb627d7e2"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100380030003000360020002800770069006e0062006c00750065005f006c007400730062002e003100350030003800300036002d00300036003000300029 } /* FileVersion winblueltsb */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310038003000300036 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_C9F4 {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "c9f47991e981394076050cb8b5cddfcbf9fb01b6d7272b9079082e20e4875cc8"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003200300033003900360020002800770069006e0062006c00750065005f006c007400730062005f0065007300630072006f0077002e003200320030003600300032002d00310037003300300029 } /* FileVersion winblueltsbescrow */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00320030003300390036 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_545C {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "545c8c806d6a8b2ab307bf7ff5dff05dd86cfc431d3920692e15e7928ac98eed"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003200300035003100390020002800770069006e0038005f006c00640072002e003100320030003900310037002d00310039003200320029 } /* FileVersion winldr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320030003500310039 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}


rule MAL_BOOTS_bootloader_Microsoftcorporation_Bootmgrexe_Microsoftwindowsoperatingsystem_B65F {
	meta:
		description = "Detects malicious bootloader mentioned in Bootloaders Project using VersionInfo values from the PE header - bootmgfw.efi"
		author = "Florian Roth"
		reference = "https://github.com/magicsword-io/bootloaders"
		hash = "b65fe0af8297168749dc235340cba7c08cf6b956fdd25fc2c9f16d20da536713"
		date = "2023-08-02"
		score = 40
	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0042006f006f00740020004d0061006e0061006700650072 } /* FileDescription BootManager */
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e } /* CompanyName MicrosoftCorporation */
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003100360034003100380020002800770069006e0038005f006700640072002e003100320030003900310037002d00310039003200310029 } /* FileVersion wingdr */
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00310036003400310038 } /* ProductVersion  */
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* InternalName bootmgrexe */
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d } /* ProductName MicrosoftWindowsOperatingSystem */
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0062006f006f0074006d00670072002e006500780065 } /* OriginalFilename bootmgrexe */
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e } /* LegalCopyright MicrosoftCorporationAllrightsreserved */
	condition:
		all of them
}
